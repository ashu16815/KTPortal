{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/323905/Documents/VibeCoding/KTPortal/src/lib/utils.ts"],"sourcesContent":["import type { RAGStatus } from '@/types'\n\n// Normalise any date to the Friday of its ISO week\nexport function normaliseWeekEnding(date: Date | string): Date {\n  const d = typeof date === 'string' ? new Date(date) : new Date(date)\n  // 0=Sun,1=Mon,...,5=Fri,6=Sat\n  const day = d.getDay()\n  const diff = day <= 5 ? 5 - day : 6 // if Saturday, go forward 6 to next Friday\n  d.setDate(d.getDate() + diff)\n  d.setHours(0, 0, 0, 0)\n  return d\n}\n\nexport function formatScore(score: number): string {\n  return `${score}/100`\n}\n\nexport function ragColor(rag: RAGStatus): string {\n  switch (rag) {\n    case 'GREEN': return '#16a34a'\n    case 'AMBER': return '#d97706'\n    case 'RED': return '#dc2626'\n  }\n}\n\nexport function ragBg(rag: RAGStatus): string {\n  switch (rag) {\n    case 'GREEN': return 'bg-green-100 text-green-800'\n    case 'AMBER': return 'bg-amber-100 text-amber-800'\n    case 'RED': return 'bg-red-100 text-red-800'\n  }\n}\n\nexport function formatDate(date: string | Date): string {\n  const d = typeof date === 'string' ? new Date(date) : date\n  return d.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })\n}\n\nexport function csvExport(headers: string[], rows: (string | number)[][]): string {\n  const escape = (v: string | number) => {\n    const s = String(v)\n    return s.includes(',') || s.includes('\"') || s.includes('\\n')\n      ? `\"${s.replace(/\"/g, '\"\"')}\"`\n      : s\n  }\n  const lines = [headers.map(escape).join(','), ...rows.map(r => r.map(escape).join(','))]\n  return lines.join('\\n')\n}\n\nexport function cn(...classes: (string | undefined | false | null)[]): string {\n  return classes.filter(Boolean).join(' ')\n}\n\nexport function safeParseJSON<T>(json: string | null | undefined, fallback: T): T {\n  if (!json) return fallback\n  try {\n    return JSON.parse(json) as T\n  } catch {\n    return fallback\n  }\n}\n\nexport function getCurrentWeekEnding(): Date {\n  return normaliseWeekEnding(new Date())\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAGO,SAAS,oBAAoB,IAAmB;IACrD,MAAM,IAAI,OAAO,SAAS,WAAW,IAAI,KAAK,QAAQ,IAAI,KAAK;IAC/D,8BAA8B;IAC9B,MAAM,MAAM,EAAE,MAAM;IACpB,MAAM,OAAO,OAAO,IAAI,IAAI,MAAM,EAAE,2CAA2C;;IAC/E,EAAE,OAAO,CAAC,EAAE,OAAO,KAAK;IACxB,EAAE,QAAQ,CAAC,GAAG,GAAG,GAAG;IACpB,OAAO;AACT;AAEO,SAAS,YAAY,KAAa;IACvC,OAAO,GAAG,MAAM,IAAI,CAAC;AACvB;AAEO,SAAS,SAAS,GAAc;IACrC,OAAQ;QACN,KAAK;YAAS,OAAO;QACrB,KAAK;YAAS,OAAO;QACrB,KAAK;YAAO,OAAO;IACrB;AACF;AAEO,SAAS,MAAM,GAAc;IAClC,OAAQ;QACN,KAAK;YAAS,OAAO;QACrB,KAAK;YAAS,OAAO;QACrB,KAAK;YAAO,OAAO;IACrB;AACF;AAEO,SAAS,WAAW,IAAmB;IAC5C,MAAM,IAAI,OAAO,SAAS,WAAW,IAAI,KAAK,QAAQ;IACtD,OAAO,EAAE,kBAAkB,CAAC,SAAS;QAAE,KAAK;QAAW,OAAO;QAAS,MAAM;IAAU;AACzF;AAEO,SAAS,UAAU,OAAiB,EAAE,IAA2B;IACtE,MAAM,SAAS,CAAC;QACd,MAAM,IAAI,OAAO;QACjB,OAAO,EAAE,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC,QACpD,CAAC,CAAC,EAAE,EAAE,OAAO,CAAC,MAAM,MAAM,CAAC,CAAC,GAC5B;IACN;IACA,MAAM,QAAQ;QAAC,QAAQ,GAAG,CAAC,QAAQ,IAAI,CAAC;WAAS,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,GAAG,CAAC,QAAQ,IAAI,CAAC;KAAM;IACxF,OAAO,MAAM,IAAI,CAAC;AACpB;AAEO,SAAS,GAAG,GAAG,OAA8C;IAClE,OAAO,QAAQ,MAAM,CAAC,SAAS,IAAI,CAAC;AACtC;AAEO,SAAS,cAAiB,IAA+B,EAAE,QAAW;IAC3E,IAAI,CAAC,MAAM,OAAO;IAClB,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,SAAS;IACd,OAAO,oBAAoB,IAAI;AACjC"}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///Users/323905/Documents/VibeCoding/KTPortal/src/components/layout/Sidebar.tsx"],"sourcesContent":["'use client'\n\nimport Link from 'next/link'\nimport { usePathname } from 'next/navigation'\nimport type { SessionUser } from '@/types'\nimport { cn } from '@/lib/utils'\n\ninterface NavItem {\n  href: string\n  label: string\n  icon: string\n  roles?: string[]\n}\n\nconst NAV: NavItem[] = [\n  { href: '/dashboard/executive', label: 'Executive', icon: 'üìä', roles: ['ADMIN', 'EXEC'] },\n  { href: '/submissions/new', label: 'Submit Update', icon: 'üìù', roles: ['TWG_LEAD', 'TCS_LEAD', 'TWG_OWNER', 'TCS_OWNER'] },\n  { href: '/submissions/compare', label: 'Compare', icon: '‚öñÔ∏è' },\n  { href: '/actions', label: 'Actions', icon: '‚úÖ' },\n  { href: '/admin', label: 'Admin', icon: '‚öôÔ∏è', roles: ['ADMIN'] },\n]\n\ninterface Props { session: SessionUser }\n\nexport function Sidebar({ session }: Props) {\n  const pathname = usePathname()\n  const visible = NAV.filter(item => !item.roles || item.roles.includes(session.role))\n\n  return (\n    <aside className=\"w-56 bg-slate-900 text-white flex flex-col flex-shrink-0\">\n      <div className=\"p-4 border-b border-slate-700\">\n        <div className=\"font-bold text-lg\">KT Portal</div>\n        <div className=\"text-xs text-slate-400\">Project Aura</div>\n      </div>\n      <nav className=\"flex-1 p-2 space-y-1\">\n        {visible.map(item => (\n          <Link\n            key={item.href}\n            href={item.href}\n            className={cn(\n              'flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors',\n              pathname.startsWith(item.href)\n                ? 'bg-slate-700 text-white'\n                : 'text-slate-300 hover:bg-slate-800 hover:text-white'\n            )}\n          >\n            <span>{item.icon}</span>\n            {item.label}\n          </Link>\n        ))}\n        {session.towerId && (\n          <Link\n            href={`/dashboard/tower/${session.towerId}`}\n            className={cn(\n              'flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors',\n              pathname.includes('/dashboard/tower/')\n                ? 'bg-slate-700 text-white'\n                : 'text-slate-300 hover:bg-slate-800 hover:text-white'\n            )}\n          >\n            <span>üèóÔ∏è</span>\n            My Tower\n          </Link>\n        )}\n      </nav>\n      <div className=\"p-3 border-t border-slate-700\">\n        <div className=\"text-xs text-slate-300 truncate\">{session.name}</div>\n        <div className=\"text-xs text-slate-500\">{session.role} ¬∑ {session.org}</div>\n      </div>\n    </aside>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAcA,MAAM,MAAiB;IACrB;QAAE,MAAM;QAAwB,OAAO;QAAa,MAAM;QAAM,OAAO;YAAC;YAAS;SAAO;IAAC;IACzF;QAAE,MAAM;QAAoB,OAAO;QAAiB,MAAM;QAAM,OAAO;YAAC;YAAY;YAAY;YAAa;SAAY;IAAC;IAC1H;QAAE,MAAM;QAAwB,OAAO;QAAW,MAAM;IAAK;IAC7D;QAAE,MAAM;QAAY,OAAO;QAAW,MAAM;IAAI;IAChD;QAAE,MAAM;QAAU,OAAO;QAAS,MAAM;QAAM,OAAO;YAAC;SAAQ;IAAC;CAChE;AAIM,SAAS,QAAQ,EAAE,OAAO,EAAS;IACxC,MAAM,WAAW,IAAA,iJAAW;IAC5B,MAAM,UAAU,IAAI,MAAM,CAAC,CAAA,OAAQ,CAAC,KAAK,KAAK,IAAI,KAAK,KAAK,CAAC,QAAQ,CAAC,QAAQ,IAAI;IAElF,qBACE,8OAAC;QAAM,WAAU;;0BACf,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;kCAAoB;;;;;;kCACnC,8OAAC;wBAAI,WAAU;kCAAyB;;;;;;;;;;;;0BAE1C,8OAAC;gBAAI,WAAU;;oBACZ,QAAQ,GAAG,CAAC,CAAA,qBACX,8OAAC,uKAAI;4BAEH,MAAM,KAAK,IAAI;4BACf,WAAW,IAAA,yHAAE,EACX,0EACA,SAAS,UAAU,CAAC,KAAK,IAAI,IACzB,4BACA;;8CAGN,8OAAC;8CAAM,KAAK,IAAI;;;;;;gCACf,KAAK,KAAK;;2BAVN,KAAK,IAAI;;;;;oBAajB,QAAQ,OAAO,kBACd,8OAAC,uKAAI;wBACH,MAAM,CAAC,iBAAiB,EAAE,QAAQ,OAAO,EAAE;wBAC3C,WAAW,IAAA,yHAAE,EACX,0EACA,SAAS,QAAQ,CAAC,uBACd,4BACA;;0CAGN,8OAAC;0CAAK;;;;;;4BAAU;;;;;;;;;;;;;0BAKtB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;kCAAmC,QAAQ,IAAI;;;;;;kCAC9D,8OAAC;wBAAI,WAAU;;4BAA0B,QAAQ,IAAI;4BAAC;4BAAI,QAAQ,GAAG;;;;;;;;;;;;;;;;;;;AAI7E"}},
    {"offset": {"line": 281, "column": 0}, "map": {"version":3,"sources":["file:///Users/323905/Documents/VibeCoding/KTPortal/src/components/layout/TopBar.tsx"],"sourcesContent":["'use client'\n\nimport type { SessionUser } from '@/types'\nimport { useRouter } from 'next/navigation'\n\ninterface Props { session: SessionUser }\n\nexport function TopBar({ session }: Props) {\n  const router = useRouter()\n\n  const handleLogout = async () => {\n    await fetch('/api/auth/logout', { method: 'POST' })\n    document.cookie = 'kt_stub_session=; path=/; max-age=0'\n    router.push('/login')\n  }\n\n  return (\n    <header className=\"h-14 bg-white border-b border-gray-200 flex items-center justify-between px-6 flex-shrink-0\">\n      <div className=\"text-sm text-gray-500\">\n        Logged in as <span className=\"font-medium text-gray-900\">{session.name}</span>\n      </div>\n      <button\n        onClick={handleLogout}\n        className=\"text-sm text-gray-500 hover:text-gray-900 px-3 py-1.5 rounded border border-gray-200 hover:bg-gray-50 transition-colors\"\n      >\n        Sign out\n      </button>\n    </header>\n  )\n}\n"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAOO,SAAS,OAAO,EAAE,OAAO,EAAS;IACvC,MAAM,SAAS,IAAA,+IAAS;IAExB,MAAM,eAAe;QACnB,MAAM,MAAM,oBAAoB;YAAE,QAAQ;QAAO;QACjD,SAAS,MAAM,GAAG;QAClB,OAAO,IAAI,CAAC;IACd;IAEA,qBACE,8OAAC;QAAO,WAAU;;0BAChB,8OAAC;gBAAI,WAAU;;oBAAwB;kCACxB,8OAAC;wBAAK,WAAU;kCAA6B,QAAQ,IAAI;;;;;;;;;;;;0BAExE,8OAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;;;;;;;AAKP"}},
    {"offset": {"line": 340, "column": 0}, "map": {"version":3,"sources":["file:///Users/323905/Documents/VibeCoding/KTPortal/src/hooks/useSession.ts"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport type { SessionUser } from '@/types'\n\nconst COOKIE_NAME = 'kt_stub_session'\n\nexport function useSession() {\n  const [session, setSession] = useState<SessionUser | null>(null)\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    const read = () => {\n      try {\n        const match = document.cookie.split('; ').find(c => c.startsWith(`${COOKIE_NAME}=`))\n        if (!match) { setSession(null); return }\n        const value = match.split('=')[1]\n        const decoded = atob(value)\n        setSession(JSON.parse(decoded) as SessionUser)\n      } catch {\n        setSession(null)\n      }\n    }\n    read()\n    setLoading(false)\n  }, [])\n\n  const logout = () => {\n    document.cookie = `${COOKIE_NAME}=; path=/; max-age=0`\n    setSession(null)\n    window.location.href = '/login'\n  }\n\n  return { session, loading, logout }\n}\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAKA,MAAM,cAAc;AAEb,SAAS;IACd,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAqB;IAC3D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,MAAM,OAAO;YACX,IAAI;gBACF,MAAM,QAAQ,SAAS,MAAM,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,UAAU,CAAC,GAAG,YAAY,CAAC,CAAC;gBAClF,IAAI,CAAC,OAAO;oBAAE,WAAW;oBAAO;gBAAO;gBACvC,MAAM,QAAQ,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;gBACjC,MAAM,UAAU,KAAK;gBACrB,WAAW,KAAK,KAAK,CAAC;YACxB,EAAE,OAAM;gBACN,WAAW;YACb;QACF;QACA;QACA,WAAW;IACb,GAAG,EAAE;IAEL,MAAM,SAAS;QACb,SAAS,MAAM,GAAG,GAAG,YAAY,oBAAoB,CAAC;QACtD,WAAW;QACX,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;IAEA,OAAO;QAAE;QAAS;QAAS;IAAO;AACpC"}},
    {"offset": {"line": 384, "column": 0}, "map": {"version":3,"sources":["file:///Users/323905/Documents/VibeCoding/KTPortal/src/components/layout/AppShell.tsx"],"sourcesContent":["'use client'\n\nimport { Sidebar } from './Sidebar'\nimport { TopBar } from './TopBar'\nimport { useSession } from '@/hooks/useSession'\nimport { useRouter } from 'next/navigation'\nimport { useEffect } from 'react'\n\nexport function AppShell({ children }: { children: React.ReactNode }) {\n  const { session, loading } = useSession()\n  const router = useRouter()\n\n  useEffect(() => {\n    if (!loading && !session) {\n      router.push('/login')\n    }\n  }, [session, loading, router])\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin\" />\n      </div>\n    )\n  }\n\n  if (!session) return null\n\n  return (\n    <div className=\"flex h-screen overflow-hidden bg-gray-50\">\n      <Sidebar session={session} />\n      <div className=\"flex flex-col flex-1 overflow-hidden\">\n        <TopBar session={session} />\n        <main className=\"flex-1 overflow-y-auto p-6\">\n          {children}\n        </main>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAQO,SAAS,SAAS,EAAE,QAAQ,EAAiC;IAClE,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,IAAA,wIAAU;IACvC,MAAM,SAAS,IAAA,+IAAS;IAExB,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,WAAW,CAAC,SAAS;YACxB,OAAO,IAAI,CAAC;QACd;IACF,GAAG;QAAC;QAAS;QAAS;KAAO;IAE7B,IAAI,SAAS;QACX,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;;;;;;;;;;IAGrB;IAEA,IAAI,CAAC,SAAS,OAAO;IAErB,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,kJAAO;gBAAC,SAAS;;;;;;0BAClB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,gJAAM;wBAAC,SAAS;;;;;;kCACjB,8OAAC;wBAAK,WAAU;kCACb;;;;;;;;;;;;;;;;;;AAKX"}},
    {"offset": {"line": 475, "column": 0}, "map": {"version":3,"sources":["file:///Users/323905/Documents/VibeCoding/KTPortal/src/components/ui/Card.tsx"],"sourcesContent":["import { cn } from '@/lib/utils'\n\ninterface CardProps {\n  children: React.ReactNode\n  className?: string\n  padding?: boolean\n  style?: React.CSSProperties\n}\n\nexport function Card({ children, className, padding = true, style }: CardProps) {\n  return (\n    <div className={cn('bg-white rounded-lg border border-gray-200 shadow-sm', padding && 'p-5', className)} style={style}>\n      {children}\n    </div>\n  )\n}\n\nexport function CardHeader({ children, className }: { children: React.ReactNode; className?: string }) {\n  return <div className={cn('mb-4', className)}>{children}</div>\n}\n\nexport function CardTitle({ children, className }: { children: React.ReactNode; className?: string }) {\n  return <h3 className={cn('text-base font-semibold text-gray-900', className)}>{children}</h3>\n}\n"],"names":[],"mappings":";;;;;;;;;AAAA;;;AASO,SAAS,KAAK,EAAE,QAAQ,EAAE,SAAS,EAAE,UAAU,IAAI,EAAE,KAAK,EAAa;IAC5E,qBACE,8OAAC;QAAI,WAAW,IAAA,yHAAE,EAAC,wDAAwD,WAAW,OAAO;QAAY,OAAO;kBAC7G;;;;;;AAGP;AAEO,SAAS,WAAW,EAAE,QAAQ,EAAE,SAAS,EAAqD;IACnG,qBAAO,8OAAC;QAAI,WAAW,IAAA,yHAAE,EAAC,QAAQ;kBAAa;;;;;;AACjD;AAEO,SAAS,UAAU,EAAE,QAAQ,EAAE,SAAS,EAAqD;IAClG,qBAAO,8OAAC;QAAG,WAAW,IAAA,yHAAE,EAAC,yCAAyC;kBAAa;;;;;;AACjF"}},
    {"offset": {"line": 522, "column": 0}, "map": {"version":3,"sources":["file:///Users/323905/Documents/VibeCoding/KTPortal/src/components/ui/Badge.tsx"],"sourcesContent":["import { cn, ragBg } from '@/lib/utils'\nimport type { RAGStatus } from '@/types'\n\ninterface BadgeProps {\n  children: React.ReactNode\n  variant?: 'default' | 'rag' | 'success' | 'warning' | 'danger' | 'info'\n  rag?: RAGStatus\n  className?: string\n}\n\nexport function Badge({ children, variant = 'default', rag, className }: BadgeProps) {\n  const base = 'inline-flex items-center px-2 py-0.5 rounded text-xs font-medium'\n  const variants = {\n    default: 'bg-gray-100 text-gray-700',\n    success: 'bg-green-100 text-green-800',\n    warning: 'bg-amber-100 text-amber-800',\n    danger: 'bg-red-100 text-red-800',\n    info: 'bg-blue-100 text-blue-800',\n    rag: rag ? ragBg(rag) : 'bg-gray-100 text-gray-700',\n  }\n  return (\n    <span className={cn(base, variants[variant], className)}>\n      {children}\n    </span>\n  )\n}\n\nexport function RAGBadge({ rag }: { rag: RAGStatus }) {\n  return <Badge variant=\"rag\" rag={rag}>{rag}</Badge>\n}\n"],"names":[],"mappings":";;;;;;;AAAA;;;AAUO,SAAS,MAAM,EAAE,QAAQ,EAAE,UAAU,SAAS,EAAE,GAAG,EAAE,SAAS,EAAc;IACjF,MAAM,OAAO;IACb,MAAM,WAAW;QACf,SAAS;QACT,SAAS;QACT,SAAS;QACT,QAAQ;QACR,MAAM;QACN,KAAK,MAAM,IAAA,4HAAK,EAAC,OAAO;IAC1B;IACA,qBACE,8OAAC;QAAK,WAAW,IAAA,yHAAE,EAAC,MAAM,QAAQ,CAAC,QAAQ,EAAE;kBAC1C;;;;;;AAGP;AAEO,SAAS,SAAS,EAAE,GAAG,EAAsB;IAClD,qBAAO,8OAAC;QAAM,SAAQ;QAAM,KAAK;kBAAM;;;;;;AACzC"}},
    {"offset": {"line": 566, "column": 0}, "map": {"version":3,"sources":["file:///Users/323905/Documents/VibeCoding/KTPortal/src/components/ui/LoadingSpinner.tsx"],"sourcesContent":["import { cn } from '@/lib/utils'\n\nexport function LoadingSpinner({ className }: { className?: string }) {\n  return (\n    <div className={cn('flex items-center justify-center p-8', className)}>\n      <div className=\"w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin\" />\n    </div>\n  )\n}\n\nexport function Skeleton({ className }: { className?: string }) {\n  return <div className={cn('animate-pulse bg-gray-200 rounded', className)} />\n}\n"],"names":[],"mappings":";;;;;;;AAAA;;;AAEO,SAAS,eAAe,EAAE,SAAS,EAA0B;IAClE,qBACE,8OAAC;QAAI,WAAW,IAAA,yHAAE,EAAC,wCAAwC;kBACzD,cAAA,8OAAC;YAAI,WAAU;;;;;;;;;;;AAGrB;AAEO,SAAS,SAAS,EAAE,SAAS,EAA0B;IAC5D,qBAAO,8OAAC;QAAI,WAAW,IAAA,yHAAE,EAAC,qCAAqC;;;;;;AACjE"}},
    {"offset": {"line": 605, "column": 0}, "map": {"version":3,"sources":["file:///Users/323905/Documents/VibeCoding/KTPortal/src/hooks/queryKeys.ts"],"sourcesContent":["export const queryKeys = {\n  towers: () => ['towers'] as const,\n  tower: (id: string) => ['towers', id] as const,\n  tracks: (towerId: string) => ['tracks', towerId] as const,\n  users: () => ['users'] as const,\n  submissions: (params?: Record<string, string>) => ['submissions', params] as const,\n  submission: (id: string) => ['submissions', id] as const,\n  compare: (towerId: string, weekEnding: string) => ['compare', towerId, weekEnding] as const,\n  actions: (params?: Record<string, string>) => ['actions', params] as const,\n  action: (id: string) => ['actions', id] as const,\n  execDashboard: (weekEnding?: string) => ['dashboard', 'exec', weekEnding] as const,\n  towerDashboard: (towerId: string, weekEnding?: string) => ['dashboard', 'tower', towerId, weekEnding] as const,\n  weights: () => ['weights'] as const,\n  audit: (page?: number) => ['audit', page] as const,\n  pulse: (submissionId?: string) => ['pulse', submissionId] as const,\n}\n"],"names":[],"mappings":";;;;AAAO,MAAM,YAAY;IACvB,QAAQ,IAAM;YAAC;SAAS;IACxB,OAAO,CAAC,KAAe;YAAC;YAAU;SAAG;IACrC,QAAQ,CAAC,UAAoB;YAAC;YAAU;SAAQ;IAChD,OAAO,IAAM;YAAC;SAAQ;IACtB,aAAa,CAAC,SAAoC;YAAC;YAAe;SAAO;IACzE,YAAY,CAAC,KAAe;YAAC;YAAe;SAAG;IAC/C,SAAS,CAAC,SAAiB,aAAuB;YAAC;YAAW;YAAS;SAAW;IAClF,SAAS,CAAC,SAAoC;YAAC;YAAW;SAAO;IACjE,QAAQ,CAAC,KAAe;YAAC;YAAW;SAAG;IACvC,eAAe,CAAC,aAAwB;YAAC;YAAa;YAAQ;SAAW;IACzE,gBAAgB,CAAC,SAAiB,aAAwB;YAAC;YAAa;YAAS;YAAS;SAAW;IACrG,SAAS,IAAM;YAAC;SAAU;IAC1B,OAAO,CAAC,OAAkB;YAAC;YAAS;SAAK;IACzC,OAAO,CAAC,eAA0B;YAAC;YAAS;SAAa;AAC3D"}},
    {"offset": {"line": 672, "column": 0}, "map": {"version":3,"sources":["file:///Users/323905/Documents/VibeCoding/KTPortal/src/app/submissions/compare/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, Suspense } from 'react'\nimport { useSearchParams } from 'next/navigation'\nimport { useQuery } from '@tanstack/react-query'\nimport { AppShell } from '@/components/layout/AppShell'\nimport { Card, CardHeader, CardTitle } from '@/components/ui/Card'\nimport { RAGBadge } from '@/components/ui/Badge'\nimport { LoadingSpinner } from '@/components/ui/LoadingSpinner'\nimport { queryKeys } from '@/hooks/queryKeys'\nimport { getCurrentWeekEnding, formatDate, formatScore } from '@/lib/utils'\nimport type { ComparePayload, TowerDTO } from '@/types'\n\nconst COMPARE_FIELDS = [\n  { label: 'Total Score', key: 'totalScore', render: (v: unknown) => <span className=\"font-bold text-gray-900\">{String(v)}/100</span> },\n  { label: 'RAG Status', key: 'ragStatus', render: (v: unknown) => <RAGBadge rag={v as 'RED' | 'AMBER' | 'GREEN'} /> },\n  { label: 'Progress', key: 'progressScore', render: (v: unknown) => formatScore(v as number) },\n  { label: 'Coverage', key: 'coverageScore', render: (v: unknown) => formatScore(v as number) },\n  { label: 'Confidence', key: 'confidenceScore', render: (v: unknown) => formatScore(v as number) },\n  { label: 'Operational', key: 'operationalScore', render: (v: unknown) => formatScore(v as number) },\n  { label: 'Quality', key: 'qualityScore', render: (v: unknown) => formatScore(v as number) },\n  { label: 'Active Blocker', key: 'hasActiveBlocker', render: (v: unknown) => v ? <span className=\"text-red-600\">‚õî Yes</span> : <span className=\"text-green-600\">‚úì No</span> },\n]\n\nfunction CompareContent() {\n  const searchParams = useSearchParams()\n  const [towerId, setTowerId] = useState(searchParams.get('towerId') ?? '')\n  const weekEnding = getCurrentWeekEnding().toISOString()\n\n  const { data: towersData } = useQuery<{ data: TowerDTO[] }>({\n    queryKey: queryKeys.towers(),\n    queryFn: async () => { const r = await fetch('/api/towers'); return r.json() },\n  })\n\n  const { data, isLoading } = useQuery<{ data: ComparePayload }>({\n    queryKey: queryKeys.compare(towerId, weekEnding),\n    queryFn: async () => {\n      const r = await fetch(`/api/submissions/compare?towerId=${towerId}&weekEnding=${encodeURIComponent(weekEnding)}`)\n      if (!r.ok) throw new Error('Failed')\n      return r.json()\n    },\n    enabled: !!towerId,\n  })\n\n  const payload = data?.data\n\n  return (\n    <div className=\"space-y-5\">\n      <Card>\n        <CardHeader><CardTitle>Select Tower</CardTitle></CardHeader>\n        <select\n          value={towerId}\n          onChange={e => setTowerId(e.target.value)}\n          className=\"block w-full max-w-sm px-3 py-2 border border-gray-300 rounded-lg text-sm bg-white focus:ring-2 focus:ring-blue-500\"\n        >\n          <option value=\"\">Choose a tower...</option>\n          {(towersData?.data ?? []).map((t: TowerDTO) => (\n            <option key={t.id} value={t.id}>{t.name}</option>\n          ))}\n        </select>\n      </Card>\n\n      {isLoading && towerId && <LoadingSpinner />}\n\n      {!towerId && (\n        <div className=\"text-center py-16 text-gray-400\">\n          <div className=\"text-4xl mb-3\">‚öñÔ∏è</div>\n          <p>Select a tower above to compare TWG and TCS submissions</p>\n        </div>\n      )}\n\n      {payload && (\n        <>\n          {payload.varianceFlagged && (\n            <div className=\"bg-orange-50 border border-orange-200 rounded-lg p-4 flex items-start gap-3\">\n              <span className=\"text-orange-500 text-xl flex-shrink-0\">‚ö†</span>\n              <div>\n                <div className=\"font-semibold text-orange-800\">High Variance Detected</div>\n                <div className=\"text-sm text-orange-700 mt-0.5\">\n                  Delta of <strong>{payload.variance} points</strong> between TWG and TCS exceeds the threshold of 20 points. Executive review recommended.\n                </div>\n              </div>\n            </div>\n          )}\n\n          <div className=\"grid grid-cols-3 gap-4\">\n            {/* Field labels */}\n            <div className=\"space-y-px\">\n              <div className=\"h-16 flex items-end pb-2\">\n                <div className=\"text-xs font-medium text-gray-400 uppercase tracking-wide\">Field</div>\n              </div>\n              {COMPARE_FIELDS.map(f => (\n                <div key={f.key} className=\"h-11 flex items-center text-sm font-medium text-gray-500 px-2\">\n                  {f.label}\n                </div>\n              ))}\n            </div>\n\n            {/* TWG */}\n            <Card padding={false} className=\"overflow-hidden\">\n              <div className=\"bg-blue-600 px-4 py-3\">\n                <div className=\"font-semibold text-white\">TWG</div>\n                <div className=\"text-xs text-blue-200\">{payload.twg?.status ?? 'No submission'}</div>\n              </div>\n              <div className=\"p-2\">\n                {payload.twg ? (\n                  COMPARE_FIELDS.map(f => {\n                    const val = (payload.twg as unknown as Record<string, unknown>)?.[f.key]\n                    const tcsVal = (payload.tcs as unknown as Record<string, unknown>)?.[f.key]\n                    const differs = payload.tcs && String(val) !== String(tcsVal) && f.key !== 'ragStatus'\n                    return (\n                      <div key={f.key} className={`h-11 flex items-center px-2 text-sm rounded-lg ${differs ? 'bg-orange-50' : ''}`}>\n                        {f.render ? f.render(val) : String(val ?? '‚Äî')}\n                        {differs && <span className=\"ml-auto text-orange-400 text-xs\">Œî</span>}\n                      </div>\n                    )\n                  })\n                ) : (\n                  <div className=\"py-6 text-center text-gray-400 text-sm\">No TWG submission this week</div>\n                )}\n              </div>\n            </Card>\n\n            {/* TCS */}\n            <Card padding={false} className=\"overflow-hidden\">\n              <div className=\"bg-green-600 px-4 py-3\">\n                <div className=\"font-semibold text-white\">TCS</div>\n                <div className=\"text-xs text-green-200\">{payload.tcs?.status ?? 'No submission'}</div>\n              </div>\n              <div className=\"p-2\">\n                {payload.tcs ? (\n                  COMPARE_FIELDS.map(f => {\n                    const val = (payload.tcs as unknown as Record<string, unknown>)?.[f.key]\n                    const twgVal = (payload.twg as unknown as Record<string, unknown>)?.[f.key]\n                    const differs = payload.twg && String(val) !== String(twgVal) && f.key !== 'ragStatus'\n                    return (\n                      <div key={f.key} className={`h-11 flex items-center px-2 text-sm rounded-lg ${differs ? 'bg-orange-50' : ''}`}>\n                        {f.render ? f.render(val) : String(val ?? '‚Äî')}\n                        {differs && <span className=\"ml-auto text-orange-400 text-xs\">Œî</span>}\n                      </div>\n                    )\n                  })\n                ) : (\n                  <div className=\"py-6 text-center text-gray-400 text-sm\">No TCS submission this week</div>\n                )}\n              </div>\n            </Card>\n          </div>\n\n          {/* Narratives */}\n          {(payload.twg?.narrative || payload.tcs?.narrative) && (\n            <div className=\"grid grid-cols-2 gap-4\">\n              <Card>\n                <CardHeader><CardTitle className=\"text-blue-700\">TWG Narrative</CardTitle></CardHeader>\n                <p className=\"text-sm text-gray-700 leading-relaxed\">{payload.twg?.narrative ?? '‚Äî'}</p>\n                {Array.isArray(payload.twg?.blockers) && payload.twg.blockers.length > 0 && (\n                  <div className=\"mt-3\">\n                    <div className=\"text-xs font-medium text-red-600 mb-1\">Blockers</div>\n                    {payload.twg.blockers.map((b, i) => <div key={i} className=\"text-xs text-red-700\">‚õî {b}</div>)}\n                  </div>\n                )}\n              </Card>\n              <Card>\n                <CardHeader><CardTitle className=\"text-green-700\">TCS Narrative</CardTitle></CardHeader>\n                <p className=\"text-sm text-gray-700 leading-relaxed\">{payload.tcs?.narrative ?? '‚Äî'}</p>\n                {Array.isArray(payload.tcs?.blockers) && payload.tcs.blockers.length > 0 && (\n                  <div className=\"mt-3\">\n                    <div className=\"text-xs font-medium text-red-600 mb-1\">Blockers</div>\n                    {payload.tcs.blockers.map((b, i) => <div key={i} className=\"text-xs text-red-700\">‚õî {b}</div>)}\n                  </div>\n                )}\n              </Card>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  )\n}\n\nexport default function ComparePage() {\n  return (\n    <AppShell>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Submission Compare</h1>\n          <p className=\"text-sm text-gray-500 mt-1\">TWG vs TCS ‚Äî Week ending {formatDate(getCurrentWeekEnding())}</p>\n        </div>\n        <Suspense fallback={<LoadingSpinner />}>\n          <CompareContent />\n        </Suspense>\n      </div>\n    </AppShell>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}